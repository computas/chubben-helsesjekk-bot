"use strict";exports.id=105,exports.ids=[105],exports.modules={56081:(e,n,t)=>{t.d(n,{AnswerLevel:()=>a,answerQuestions:()=>S,createAsked:()=>D,createTeam:()=>y,deactivateTeam:()=>H,deleteQuestionFromTeam:()=>M,getActiveAsk:()=>w,getActiveTeams:()=>L,getAnswer:()=>G,getAsked:()=>f,getBrokenAsks:()=>q,getPreviousAsk:()=>v,getTeam:()=>k,getTeamByAdGroupAndTeamId:()=>I,getTeamsByAdGroups:()=>h,getTeamsToReveal:()=>O,hasActiveAsk:()=>c,hasActiveUnnaggedAsk:()=>p,hasAskedToday:()=>m,markAskedAsNagged:()=>A,markAskedRevealed:()=>g,updateTeam:()=>E,updateTeamGroupAssociation:()=>T});var r,a,s=t(84770),i=t(96279),d=t(7895),o=t(35379);(function(e){e[e.MONDAY=0]="MONDAY",e[e.TUESDAY=1]="TUESDAY",e[e.WEDNESDAY=2]="WEDNESDAY",e[e.THURSDAY=3]="THURSDAY",e[e.FRIDAY=4]="FRIDAY",e[e.SATURDAY=5]="SATURDAY",e[e.SUNDAY=6]="SUNDAY"})(r||(r={})),function(e){e.GOOD="GOOD",e.MEDIUM="MEDIUM",e.BAD="BAD"}(a||(a={}));var u=t(87924),l=t(24120);async function c(e){return await (0,u.prisma)().asked.findFirst({where:{teamId:e,revealed:!1,skipped:!1}})!=null}async function m(e){return await (0,u.prisma)().asked.findFirst({where:{teamId:e,timestamp:{gte:(0,l.b)(new Date)}}})!=null}async function p(e){return await (0,u.prisma)().asked.findFirst({where:{teamId:e,revealed:!1,nagged:!1}})!=null}async function w(e){return(0,u.prisma)().asked.findFirst({where:{teamId:e,revealed:!1,skipped:!1},include:{answers:!0}})}async function v(e){return(0,u.prisma)().asked.findFirst({where:{teamId:e.teamId,revealed:!0,id:{not:e.id},skipped:!1},orderBy:{timestamp:"desc"},include:{answers:!0}})}async function g(e,n=!1){await (0,u.prisma)().asked.update({where:{id:e},data:{revealed:!0,skipped:n}})}async function A(e){await (0,u.prisma)().asked.update({where:{id:e},data:{nagged:!0}})}async function f(e,n){return(0,u.prisma)().asked.findFirst({where:{messageTs:n,teamId:e}})}async function D(e,n,t){return(0,u.prisma)().asked.create({data:{teamId:n,messageTs:e,timestamp:new Date,questions:(0,i.ST)(t),revealed:!1,nagged:!1}})}async function k(e){return(0,u.prisma)().team.findFirst({where:{id:e}})}async function h(e){return(0,u.prisma)().team.findMany({where:{assosiatedGroup:{in:e}}})}async function I(e,n){let t=await (0,u.prisma)().team.findFirst({where:{id:n,assosiatedGroup:{contains:e}},include:{Asked:{where:{revealed:!1,skipped:!1}}}});return null==t?null:{...t,activeAskTs:t.Asked.length>0?t.Asked[0].messageTs:null}}async function y(e,n){return(0,u.prisma)().team.create({data:{id:e,name:n,active:!0,postDay:r.FRIDAY,postHour:14,revealDay:r.MONDAY,revealHour:10,questions:(0,i.ST)([{questionId:(0,d.Z)(),question:"Stress",answers:{HIGH:"Ting er behagelige og jeg kjenner meg ikke stresset",MID:"Litt s\xe5nn midt i mellom",LOW:"Jeg er stresset og opplever ubehag i forbindelse med jobben"},type:o.c.TEAM_HEALTH},{questionId:(0,d.Z)(),question:"Feedback",answers:{HIGH:"Vi st\xf8tter hverandres utvikling ved \xe5 gi hverandre positiv og kontruktiv feedback",MID:"Litt s\xe5nn midt i mellom",LOW:"Vi vet ikke hvordan vi skal gi hverandre feedback p\xe5 en konstruktiv m\xe5te"},type:o.c.TEAM_HEALTH},{questionId:(0,d.Z)(),question:"Samarbeid",answers:{HIGH:"Vi er et godt fungerende team der samarbeidet fungerer str\xe5lende",MID:"Litt s\xe5nn midt i mellom",LOW:"Vi er en gjeng individualister der alle driver p\xe5 med sine egne greier. Jeg aner ikke hva de andre gj\xf8r"},type:o.c.TEAM_HEALTH},{questionId:(0,d.Z)(),question:"St\xf8tte",answers:{HIGH:"Vi f\xe5r all hjelp vi trenger fra de rundt oss",MID:"Litt s\xe5nn midt i mellom",LOW:"Ting stopper opp hele tiden fordi vi m\xe5 vente p\xe5 andre"},type:o.c.SPEED},{questionId:(0,d.Z)(),question:"Fart",answers:{HIGH:"Vi f\xe5r gjort ting raskt",MID:"Litt s\xe5nn midt i mellom",LOW:"Ting stopper opp hele tiden. Vi er aldri enige om hva som har prioritet eller hvordan ting skal l\xf8ses"},type:o.c.SPEED},{questionId:(0,d.Z)(),question:"Oppdrag",answers:{HIGH:"Vi vet akkurat hvorfor vi er her og vi digger det",MID:"Litt s\xe5nn midt i mellom",LOW:"Vi vet ikke helt hvor vi skal. Oppdraget v\xe5rt er lite tydelig og ikke inspirerende"},type:o.c.SPEED}])}})}async function T(e,n){return(0,u.prisma)().team.update({data:{assosiatedGroup:n},where:{id:e}})}async function E(e,n,t){return(0,u.prisma)().$transaction(async r=>{let a=await r.team.findFirstOrThrow({where:{id:e}});return r.team.update({data:{name:n.name,active:n.active,postDay:n.postDay,postHour:n.postHour,revealDay:n.revealDay,revealHour:n.revealHour,questions:null!=t?(0,i.ST)([...(0,i.Pg)(a.questions),{questionId:(0,s.randomUUID)(),question:t.question,answers:{LOW:t.low,MID:t.mid,HIGH:t.high},type:t.category,custom:!0}]):void 0},where:{id:e}})})}function M(e,n){return(0,u.prisma)().$transaction(async t=>{let r=await t.team.findFirstOrThrow({where:{id:e}});return t.team.update({data:{questions:(0,i.ST)((0,i.Pg)(r.questions).filter(e=>e.questionId!==n))},where:{id:e}})})}async function H(e){let n=await w(e);return(0,u.prisma)().$transaction(async t=>{let r=await t.team.update({data:{active:!1},where:{id:e}});return null!=n&&await t.asked.update({where:{id:n.id},data:{revealed:!0,nagged:!0,skipped:!0}}),r})}async function L(){return(0,u.prisma)().team.findMany({where:{active:!0}})}async function O(){return(0,u.prisma)().team.findMany({where:{active:!0,Asked:{some:{revealed:!1,skipped:!1}}}})}async function q(){return(0,u.prisma)().asked.findMany({where:{revealed:!1,skipped:!0}})}async function S(e,n,t){var r;let a=(0,i.lV)((r=(0,i.Pg)(e.questions),n.map(([e,n])=>{let t=r.find(n=>n.questionId===e);if(null==t)throw Error(`Unable to find question with id ${e}`);return{answer:n,questionId:t.questionId,type:t.type}})));await (0,u.prisma)().answer.upsert({create:{userId:t,askedId:e.id,answeredAt:new Date,answers:a},update:{answers:a},where:{userId_askedId:{userId:t,askedId:e.id}}})}async function G(e,n){return(0,u.prisma)().answer.findFirst({where:{userId:e,askedId:n}})}},87924:(e,n,t)=>{t.d(n,{prisma:()=>a});var r=t(53524);let a=(0,t(93430).s)("prisma",()=>{let e=new r.PrismaClient({log:[{emit:"event",level:"warn"},{emit:"event",level:"error"}]});return e.$on("error",e=>{console.error(e)}),e.$on("warn",e=>{console.error(e)}),e})},46005:(e,n,t)=>{t.d(n,{q:()=>w});var r=t(67166),a=t(40719),s=t(46231),i=t(61121),d=t(71785),o=t(83562),u=t(26075),l=t(5923),c=t(96279),m=t(56081);function p(e,n){return e.filter(e=>e.answer===n).length}function w(e){let n=(0,c.Pg)(e.questions),t=v(e.answers),s=r.a(n,a.a(e=>{let n=t[e.questionId],r=e.required??!0;if(!r&&(null==n||n.length<3))return{id:e.questionId,question:e.question,answers:{[m.AnswerLevel.GOOD]:e.answers.HIGH,[m.AnswerLevel.MEDIUM]:e.answers.MID,[m.AnswerLevel.BAD]:e.answers.LOW},distribution:{[m.AnswerLevel.GOOD]:null,[m.AnswerLevel.MEDIUM]:null,[m.AnswerLevel.BAD]:null},type:e.type,score:0,answerCount:n?.length??0,optional:!0};let a=g(n);return{id:e.questionId,question:e.question,answers:{[m.AnswerLevel.GOOD]:e.answers.HIGH,[m.AnswerLevel.MEDIUM]:e.answers.MID,[m.AnswerLevel.BAD]:e.answers.LOW},score:a,type:e.type,distribution:{[m.AnswerLevel.GOOD]:p(n,m.AnswerLevel.GOOD),[m.AnswerLevel.MEDIUM]:p(n,m.AnswerLevel.MEDIUM),[m.AnswerLevel.BAD]:p(n,m.AnswerLevel.BAD)},answerCount:n.length,optional:!r}}));return{totalScore:function(e){let n=e.filter(e=>e.answerCount>=3);return r.a(n,a.a(i.a("score")),u.a(l.a()),e=>e/n.length)}(s),scoredQuestions:s,answerCount:e.answers.length,timestamp:e.timestamp,messageTs:e.messageTs}}let v=s.a(a.a(i.a("answers")),d.a(c.fe),o.a(i.a("questionId"))),g=e=>r.a(e,a.a(A),u.a(l.a()),n=>n/e.length);function A(e){switch(e.answer){case m.AnswerLevel.GOOD:return 5;case m.AnswerLevel.MEDIUM:return 2.5;case m.AnswerLevel.BAD:return 1}}},96279:(e,n,t)=>{function r(e){return e}function a(e){return e}function s(e){return e}function i(e){return e}t.d(n,{Pg:()=>a,ST:()=>r,fe:()=>i,lV:()=>s})},35379:(e,n,t)=>{var r,a;t.d(n,{c:()=>r}),function(e){e.TEAM_HEALTH="TEAM_HEALTH",e.SPEED="SPEED",e.TECH="TECH",e.OTHER="OTHER"}(r||(r={})),function(e){e.GOOD="GOOD",e.MEDIUM="MEDIUM",e.BAD="BAD"}(a||(a={}))},17569:(e,n,t)=>{t.d(n,{JT:()=>u,dJ:()=>p,hR:()=>m,i1:()=>l,jQ:()=>w,uW:()=>o});var r=t(74180),a=t(41403),s=t(23566),i=t(5659),d=t(64253);function o(e){return(0,r.Q)(e,{weekStartsOn:1,locale:d.nb})}function u(){return new Date(new Date().toLocaleString("en",{timeZone:"Europe/Oslo"}))}function l(e){return((0,a.w)(e)+6)%7}let c=["mandag","tirsdag","onsdag","torsdag","fredag","l\xf8rdag","s\xf8ndag"];function m(e){return c[e]}function p(e){let n=u();return(0,s.j)(e,n)}function w(e){let n=u();return(0,i.A)(e,n)}}};